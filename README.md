# Text Classification of News Articles

__M√¥ t·∫£:__ Project x√¢y d·ª±ng m√¥ h√¨nh ph√¢n lo·∫°i b√†i b√°o theo ch·ªß ƒë·ªÅ khi nh·∫≠n ƒë∆∞·ª£c link ( ph·∫°m vi https://vietnambiz.vn ).

---
## üöÄ C√†i ƒë·∫∑t th∆∞ vi·ªán
Th·ª±c hi·ªán c√†i ƒë·∫∑t c√°c packages trong `requirements.txt` th√¥ng qua cmd:

```bash
pip install -r requirements.txt
```
---
## ‚ú® Demo
Th·ª±c hi·ªán run file `main.py` th√¥ng qua cmd:

```bash
python main.py
```
Copy link b√†i b√°o b·∫•t k·ª≥ t·ª´ ngu·ªìn https://vietnambiz.vn v√† paste v√†o tool, sau ƒë√≥ __`Enter`__ ƒë·ªÉ l·∫•y nh√£n d·ª± b√°o. Ngo√†i ra, tr√¨nh ghi log s·∫Ω ghi v√†o file `log_prediction.log`.

<p align="center">
  <img width="700" align="center" src="https://github.com/datkt1998/Text-Classification-of-News-Articles/blob/f0760a02a24586efdf89e4d90150fa858c6c9be9/outputs/figures/demo.gif?raw=true" alt="demo"/>
</p>

---
## C·∫•u tr√∫c th∆∞ m·ª•c
```bash
.
‚îú‚îÄ‚îÄ code_in_dev.ipynb                                # notebook ch·∫°y workflow trong vi·ªác build model
‚îú‚îÄ‚îÄ configs                                          # th∆∞ m·ª•c ch·ª©a c√°c config c·ªßa project
‚îÇ         ‚îú‚îÄ‚îÄ cfg.yaml                                   # file config c·ªßa project
‚îÇ         ‚îî‚îÄ‚îÄ vietnamese-stopwords-dash.txt              # file t·ªïng h·ª£p stopwords ti·∫øng vi·ªát
‚îú‚îÄ‚îÄ datasets                                         # th∆∞ m·ª•c ch·ª©a datasets
‚îÇ         ‚îú‚îÄ‚îÄ preprocessed                               # th∆∞ m·ª•c ch·ª©a datasets ƒë√£ qua preprocessing
‚îÇ         ‚îî‚îÄ‚îÄ raw                                        # th∆∞ m·ª•c ch·ª©a raw-datasets
‚îú‚îÄ‚îÄ helper                                           # th∆∞ m·ª•c helper ch·ª©a c√°c function c·ªßa project
‚îÇ         ‚îú‚îÄ‚îÄ cfg.py                                     # load d·ªØ li·ªáu configs
‚îÇ         ‚îú‚îÄ‚îÄ modeling.py                                # models 
‚îÇ         ‚îú‚îÄ‚îÄ preprocessing.py                           # h√†m preprocessing
‚îÇ         ‚îî‚îÄ‚îÄ utils.py                                   # h√†m b·ªï sung
‚îú‚îÄ‚îÄ log_prediction.log                               # ghi log d·ªØ li·ªáu predictions
‚îú‚îÄ‚îÄ main.py                                          # script python ch·∫°y tool
‚îú‚îÄ‚îÄ models                                           # th∆∞ m·ª•c ch·ª©a final models theo version
‚îÇ         ‚îî‚îÄ‚îÄ models_v1.0                                # final models version 1.0
‚îú‚îÄ‚îÄ outputs                                          # th∆∞ m·ª•c ch·ª©a c√°c output trong qu√° tr√¨nh ph√¢n t√≠ch v√† x√¢y d·ª±ng model
‚îÇ         ‚îú‚îÄ‚îÄ figures                                    # th∆∞ m·ª•c ch·ª©a images output
‚îÇ         ‚îú‚îÄ‚îÄ models                                     # th∆∞ m·ª•c ch·ª©a c√°c experimental model
‚îÇ         ‚îú‚îÄ‚îÄ reports                                    # th∆∞ m·ª•c ch·ª©a reports
‚îÇ         ‚îî‚îÄ‚îÄ results                                    # th∆∞ m·ª•c ch·ª©a results
‚îú‚îÄ‚îÄ references                                       # th∆∞ m·ª•c ch·ª©a t√†i li·ªáu c√≥ li√™n quan
‚îî‚îÄ‚îÄ requirements.txt                                 # file y√™u c·∫ßu c√†i ƒë·∫∑t packages c·∫ßn thi·∫øt
```


---
## M√¥ t·∫£ d·ª± √°n

### M·ª•c ti√™u b√†i to√°n
X√¢y d·ª±ng m√¥ h√¨nh c√≥ kh·∫£ nƒÉng ph√¢n lo·∫°i b√†i b√°o th√¥ng qua vi·ªác ph√¢n t√≠ch title v√† content l·∫•y ƒë∆∞·ª£c link b√†i b√°o t·ª´ ngu·ªìn https://vietnambiz.vn.

C√°c label d·ª± b√°o bao g·ªìm: _**Stock market**_, _**International news**_, _**Macro news**_.

### Project workflow

![](https://github.com/datkt1998/Text-Classification-of-News-Articles/blob/9095155bc50394693bd6081f079f604e6e7e4e6a/outputs/figures/Projectworkflow.png?raw=true)

### Khai ph√° d·ªØ li·ªáu

Th√¥ng tin b·ªô d·ªØ li·ªáu raw:
- **Tr∆∞·ªùng th√¥ng tin**: **text** (text b√†i b√°o), **category** (label ph√¢n lo·∫°i)
- **Size**: 48048

T·ª∑ tr·ªçng labels: _balance_
<p align="center">
  <img width="350" align="center" src="https://github.com/datkt1998/Text-Classification-of-News-Articles/blob/f0760a02a24586efdf89e4d90150fa858c6c9be9/outputs/figures/check_balance_labels.png?raw=true" alt="demo"/>
</p>

Ph√¢n chia **train**/**test**: t·ª∑ tr·ªçng 0.85 / 0.15 _(stratify theo label)_

### Quy tr√¨nh ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu

* **Label** ƒë∆∞·ª£c encode theo ph∆∞∆°ng ph√°p `LabelEncoder` 
* **Data** l√† text ti·∫øng vi·ªát ƒë∆∞·ª£c chu·∫©n ho√° theo workflow:

![](https://github.com/datkt1998/Text-Classification-of-News-Articles/blob/f0760a02a24586efdf89e4d90150fa858c6c9be9/outputs/figures/preprocessing_workflow.png?raw=true)

### X√¢y d·ª±ng v√† l·ª±a ch·ªçn m√¥ h√¨nh

| Number | Models                                                       | ∆Øu ƒëi·ªÉm                                                                                                        | Nh∆∞·ª£c ƒëi·ªÉm                                                                                                                           | Accuracy | L·ª±a ch·ªçn |
|--------|--------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------|----------|----------|
| 1      | TF-IDF vectorization + Multinomial Naive Bayes               | Y√™u c·∫ßu l∆∞·ª£ng trainset nh·ªè ƒë·ªÉ ∆∞·ªõc l∆∞·ª£ng, kh·∫£ nƒÉng train nhanh                                                  | Kh·∫£ nƒÉng d·ª± b√°o kh√¥ng t·ªët v√† x√°c su·∫•t ph√¢n b·ªë tu√¢n theo c√°c gi·∫£ ƒë·ªãnh v·ªÅ h√¨nh d·∫°ng c·ªßa ph√¢n b·ªë d·ªØ li·ªáu, c≈©ng nh∆∞ ph·∫£i update li√™n t·ª•c | ~ 83%    | Kh√¥ng    |
| 2      | TF-IDF vectorization + Logistic Regression                   | Tr√≠ch l·ªçc ƒë∆∞·ª£c c√°c ƒë·∫∑c tr∆∞ng quan tr·ªçng n·∫øu tunning v√† l·ª±a ch·ªçn features h·ª£p l√Ω                                | Kh√¥ng ph√π h·ª£p v·ªõi training d·ªØ li·ªáu real-time ho·∫∑c d·ªØ li·ªáu l·ªõn, kh√¥ng h·ªçc ƒë∆∞·ª£c ng·ªØ c·∫£nh c·ªßa text.                                     | ~ 90%    | C√≥       |
| 3      | TF-IDF vectorization + Support Vector Machine Classification | K·∫øt qu·∫£ d·ª± ƒëo√°n cao v·ªõi nh·ªØng words trong vocabulary                                                           | Kh√¥ng th√≠ch h·ª£p v·ªõi train d·ªØ li·ªáu l·ªõn v√¨ t·ªën th·ªùi gian t√≠nh to√°n ma tr·∫≠n t·ª´ v·ª±ng ƒëa chi·ªÅu, ho·∫∑c non-linear data                      | ~ 91%    | C√≥       |
| 4      | TF-IDF vectorization + RandomForest Classification           | S·ª≠ d·ª•ng c∆° ch·∫ø bagging tree-base model, gi√∫p ƒë√°nh gi√° nhi·ªÅu y·∫øu t·ªë t·ª´ c√°c submodel ƒë·ªÉ ƒë∆∞a ra k·∫øt qu·∫£ t·ªïng th·ªÉ. | C·∫ßn nhi·ªÅu th·ªùi gian tunning tham s·ªë v√† kh√≥ d·ª± ƒëo√°n nh·ªØng t·ª´ √≠t xu·∫•t hi·ªán.                                                            | ~ 80%    | Kh√¥ng    |
| 5      | Neural Network Embeddings                                    | H·ªçc ƒë∆∞·ª£c ng·ªØ c·∫£nh c·ªßa text n·∫øu thi·∫øt l·∫≠p memory trong t·ª´ng node.                                               | Kh√≥ gi·∫£i th√≠ch, c·∫ßn th·ªùi gian training l√¢u v√† t·ªëi ∆∞u ki·∫øn tr√∫c m·∫°ng neural                                                           | ~ 89%    | C√≥       |

**Model pipeline:** S·ª≠ d·ª•ng ensemble 3 model ƒë∆∞·ª£c l·ª±a ch·ªçn ph√≠a tr√™n theo ph∆∞∆°ng ph√°p trung b√¨nh x√°c su·∫•t d·ª± ƒëo√°n.


### ƒê√°nh gi√° hi·ªáu nƒÉng ensemble model (testset)

1. **Performance reports**

| Classname          | Precision | Recall | F1-score | Accuracy | 
|--------------------|-----------|--------|----------|----------|
| International news | 91%       | 93%    | 92%      | 90%      |
| Macro news         | 89%       | 88%    | 89%      | 90%      |
| Stock market       | 91%       | 90%    | 90%      | 90%      |

2. **Confusion matrix**

![](https://github.com/datkt1998/Text-Classification-of-News-Articles/blob/f0760a02a24586efdf89e4d90150fa858c6c9be9/outputs/figures/cm.png?raw=true)

3. **The most wrong predictions**

B·∫£ng th·ªëng k√™ nh·ªØng quan s√°t d·ª± ƒëo√°n sai v·ªõi x√°c su·∫•t d·ª± ƒëo√°n cao nh·∫•t trong testset 

| no | text                                                                                                     | label th·ª±c t·∫ø | label d·ª± ƒëo√°n      | x√°c su·∫•t d·ª± ƒëo√°n |
|----|----------------------------------------------------------------------------------------------------------| ------------- |--------------------|------------------|
| 1  | 44 tri·ªáu ng∆∞·ªùi vi·ªát gia nh·∫≠p t·∫ßng l·ªõp trung l∆∞u, 44% ti·∫øp c·∫≠n d·ªãch v·ª• t√†i ch√≠nh s·ªë, s·∫øp dn ph·∫ßn m·ªÅm  ... | stock_market  | macro_news         | 99,92%           |
| 2  | √°p d·ª•ng th√≠ ƒëi·ªÉm ·ª©ng d·ª•ng vssid - b·∫£o hi·ªÉm x√£ h·ªôi s·ªë ƒë·ªëi v·ªõi 10 t·ªânh ch·ªãu ·∫£nh h∆∞·ªüng b·ªüi b√£o, l≈©  ...     | stock_market  | macro_news         | 99,92%           |
| 3  | gs. nguy·ªÖn m·∫°i: 1 t·ª∑ usd v·ªën h√†n qu·ªëc ƒë·∫ßu t∆∞ v√†o vingroup l√† v√≠ d·ª• cho th·∫•y t√≠nh h·∫•p d·∫´n c·ªßa th·ªã  ...    | stock_market  | macro_news         | 99,64%           |
| 4  | Gi·ªõi si√™u gi√†u M·ªπ s·∫Ω ƒë·ªï x√¥ v√†o bitcoin ƒë·ªÉ tr√°nh tƒÉng thu·∫ø? Sau khi T·ªïng th·ªëng Biden ƒë·ªÅ xu·∫•t tƒÉng  ...    | stock_market  | international_news | 99,24%           |
| 5  | t·ª∑ gi√° usd h√¥m nay 30/12: ƒë√† gi·∫£m ch·∫≠m l·∫°i khi th∆∞·ª£ng vi·ªán m·ªπ tr√¨ ho√£n vi·ªác gia tƒÉng g√≥i k√≠ch ...        | stock_market  | international_news | 99,24%           |
| 6  | th·ªã tr∆∞·ªùng ngo·∫°i h·ªëi h√¥m nay (15/5): usd tƒÉng cao khi kh·∫£ nƒÉng c·∫Øt gi·∫£m l√£i su·∫•t c·ªßa m·ªπ gi·∫£m ...         | stock_market  | international_news | 99,16%           |
| 7  | ch·ªß t·ªãch agribank l√†m ch·ªß t·ªãch hi·ªáp h·ªôi ng√¢n h√†ng vi·ªát nam Hi·ªáp h·ªôi Ng√¢n h√†ng Vi·ªát Nam v·ª´a c√≥ ...        | stock_market  | macro_news         | 99,15%           |
| 8  | v·ªën ngo·∫°i fdi v√†o vi·ªát nam ƒëang gi·∫£m: c√≥ ƒë√°ng lo? B√°o c√°o t√¨nh h√¨nh ƒë·∫ßu t∆∞ tr·ª±c ti·∫øp n∆∞·ªõc  ...           | stock_market  | macro_news         | 99,09%           |
| 9  | t·ª∑ gi√° usd h√¥m nay 1/8: vietinbank gi·∫£m 3 ƒë·ªìng ·ªü gi√° mua T·ª∑ gi√° USD tr√™n th·ªã tr∆∞·ªùng qu·ªëc t·∫ø  ...         | stock_market  | international_news | 99,01%           |
| 10 | apple toan t√≠nh l·ªõn h∆°n v·ªõi th·ªã tr∆∞·ªùng vi·ªát nam Th√¥ng tin v·ªÅ vi·ªác Apple s·∫Ω chuy·ªÉn c√¥ng ƒëo·∫°n   ...        | stock_market  | macro_news         | 98,82%           |

> C√°c d·ª± b√°o sai c√≥ kh·∫£ nƒÉng ph√°t hi·ªán nh·ªØng sai l·ªách v·ªÅ label c·ªßa d·ªØ li·ªáu ngo√†i th·ª±c t·∫ø.





---
## T√°c gi·∫£

üë§ **Kh·ªïng Ti·∫øn ƒê·∫°t**

- Zalo: 0944921214
- Linkedin: [ktd1998](https://www.linkedin.com/in/ktd1998/)
- Github: [datkt1998](https://github.com/datkt1998)

## Log

* 19 May 2023 - Ho√†n th√†nh phi√™n b·∫£n 1.0 v·ªõi vi·ªác s·ª≠ d·ª•ng ensemble 3 models bao g·ªìm: **Logistic Regression**, **Support Vector Machine**, **Neural Network Embeddings**.